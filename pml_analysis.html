<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<h1>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</h1>

<h1>&mdash;-            Coursera: Practical Machine Learning            &mdash;-</h1>

<h1>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</h1>

<p>Author = J.Kromme
Date = 20-8-2014</p>

<p>This document is part of the Coursera course Practical Machine Learning hosted by John Hopkins Bloomberg School of Public health. Given by Jeff Leek, PhD, Roger D. Peng, PhD, Brian Caffo, PhD.</p>

<p>6 Persons performed barbell lifts correctly and incorrectly while wearing accelerometers on the belt, forarm, arm and dumbell. The dependent variable is a factor with five levels: A, B, C, D and E. The task for this assignment is to predict, using the given data, whether the barbell lift was done correctly or not. To evaluate the outcome of our analysis we got, besides a trainingset, a testset containing 20 cases. My result was 20 out of 20 correct! To evaluate within this assignment, I split the trainingset in a trainingset and a holdoutset (called: validationset).</p>

<p>Data was provides by the university, source:  <a href="http://groupware.les.inf.puc-rio.br/har">http://groupware.les.inf.puc-rio.br/har</a>.</p>

<p>First, load the need packages. </p>

<pre><code class="r"># ---- Load packages ---- #
rm(list=ls())
set.seed(1234)
library(caret)
</code></pre>

<pre><code>## Loading required package: lattice
## Loading required package: ggplot2
</code></pre>

<pre><code class="r">library(splines)
library(ggplot2)
library(rattle)
</code></pre>

<pre><code>## Rattle: A free graphical interface for data mining with R.
## Version 3.1.0 Copyright (c) 2006-2014 Togaware Pty Ltd.
## Type &#39;rattle()&#39; to shake, rattle, and roll your data.
</code></pre>

<pre><code class="r">library(rpart)
library(rpart.plot)
library(klaR)
</code></pre>

<pre><code>## Loading required package: MASS
</code></pre>

<pre><code class="r">library(foreach)
library(doParallel)
</code></pre>

<pre><code>## Loading required package: iterators
## Loading required package: parallel
</code></pre>

<pre><code class="r">library(randomForest)
</code></pre>

<pre><code>## randomForest 4.6-7
## Type rfNews() to see new features/changes/bug fixes.
</code></pre>

<p>The files are read and the trainingset is split into two set: trainingset and validationset. The files contained the values &#39;#DIV/0!&#39;, these are excluded at reading in the data.</p>

<pre><code class="r"># ---- Load data ---- #
# load data
# some &#39;#DIV/0!&#39; appears in data, delete those by reading in data
trainingset &lt;- read.csv(&#39;./data/training.csv&#39;, na.strings = c(&#39;#DIV/0!&#39;, &#39;NA&#39;) )
testset &lt;- read.csv(&#39;./data/test.csv&#39;, na.strings = c(&#39;#DIV/0!&#39;, &#39;NA&#39;) )

# partition train into train / validation set. to validate model as testset doesn&#39;t have a DV.
inTrain &lt;- createDataPartition(trainingset[,1], p=0.7, list= FALSE)
trainingset &lt;- trainingset[inTrain,]
validationset &lt;-trainingset[-inTrain,]

# backup data
trainingsetBackup &lt;- trainingset
testsetBackup     &lt;- testset
validationsetBackup &lt;- validationset
</code></pre>

<p>Data preparation is needed. First all columns where more then 60% of the values are missing are deleted. Also the first seven variables are deleted due to theoretical reasons, for example, you don&#39;t want to use an ID number of who is doing the execise as a predictor variable. Furthermore, I looked at NZV-variables, they did not exist. I also looked at histograms of all variables, I commented them out in this document otherwise there would be an overload of redundant graphs. But it did show some that some variables are highly skewed, or consists of two normal distributions. The featureplot confirmed this. This indicates non-linear effects.</p>

<pre><code class="r"># ---- Data preparation ---- #
#summary(trainingset)

# -- missing values
# so many missing values, imputing won&#39;t help. therefore delete these
toBeDeleted = list()
for (col in 1:ncol(trainingset)){
  # for each column, count number of missing values
  noOfMissingValues = length(trainingset[!complete.cases(trainingset[,col]),col])
  # if 40% or more is missing, delete variable from traing and testset
  if (noOfMissingValues &gt; nrow(trainingset) * 0.4){

    cat(&#39;delete due to too many missing values:&#39;, names(trainingset)[col], &#39;\n&#39;)
    toBeDeleted = c(toBeDeleted, names(trainingset)[col])
  }
}
</code></pre>

<pre><code>## delete due to too many missing values: kurtosis_roll_belt 
## delete due to too many missing values: kurtosis_picth_belt 
## delete due to too many missing values: kurtosis_yaw_belt 
## delete due to too many missing values: skewness_roll_belt 
## delete due to too many missing values: skewness_roll_belt.1 
## delete due to too many missing values: skewness_yaw_belt 
## delete due to too many missing values: max_roll_belt 
## delete due to too many missing values: max_picth_belt 
## delete due to too many missing values: max_yaw_belt 
## delete due to too many missing values: min_roll_belt 
## delete due to too many missing values: min_pitch_belt 
## delete due to too many missing values: min_yaw_belt 
## delete due to too many missing values: amplitude_roll_belt 
## delete due to too many missing values: amplitude_pitch_belt 
## delete due to too many missing values: amplitude_yaw_belt 
## delete due to too many missing values: var_total_accel_belt 
## delete due to too many missing values: avg_roll_belt 
## delete due to too many missing values: stddev_roll_belt 
## delete due to too many missing values: var_roll_belt 
## delete due to too many missing values: avg_pitch_belt 
## delete due to too many missing values: stddev_pitch_belt 
## delete due to too many missing values: var_pitch_belt 
## delete due to too many missing values: avg_yaw_belt 
## delete due to too many missing values: stddev_yaw_belt 
## delete due to too many missing values: var_yaw_belt 
## delete due to too many missing values: var_accel_arm 
## delete due to too many missing values: avg_roll_arm 
## delete due to too many missing values: stddev_roll_arm 
## delete due to too many missing values: var_roll_arm 
## delete due to too many missing values: avg_pitch_arm 
## delete due to too many missing values: stddev_pitch_arm 
## delete due to too many missing values: var_pitch_arm 
## delete due to too many missing values: avg_yaw_arm 
## delete due to too many missing values: stddev_yaw_arm 
## delete due to too many missing values: var_yaw_arm 
## delete due to too many missing values: kurtosis_roll_arm 
## delete due to too many missing values: kurtosis_picth_arm 
## delete due to too many missing values: kurtosis_yaw_arm 
## delete due to too many missing values: skewness_roll_arm 
## delete due to too many missing values: skewness_pitch_arm 
## delete due to too many missing values: skewness_yaw_arm 
## delete due to too many missing values: max_roll_arm 
## delete due to too many missing values: max_picth_arm 
## delete due to too many missing values: max_yaw_arm 
## delete due to too many missing values: min_roll_arm 
## delete due to too many missing values: min_pitch_arm 
## delete due to too many missing values: min_yaw_arm 
## delete due to too many missing values: amplitude_roll_arm 
## delete due to too many missing values: amplitude_pitch_arm 
## delete due to too many missing values: amplitude_yaw_arm 
## delete due to too many missing values: kurtosis_roll_dumbbell 
## delete due to too many missing values: kurtosis_picth_dumbbell 
## delete due to too many missing values: kurtosis_yaw_dumbbell 
## delete due to too many missing values: skewness_roll_dumbbell 
## delete due to too many missing values: skewness_pitch_dumbbell 
## delete due to too many missing values: skewness_yaw_dumbbell 
## delete due to too many missing values: max_roll_dumbbell 
## delete due to too many missing values: max_picth_dumbbell 
## delete due to too many missing values: max_yaw_dumbbell 
## delete due to too many missing values: min_roll_dumbbell 
## delete due to too many missing values: min_pitch_dumbbell 
## delete due to too many missing values: min_yaw_dumbbell 
## delete due to too many missing values: amplitude_roll_dumbbell 
## delete due to too many missing values: amplitude_pitch_dumbbell 
## delete due to too many missing values: amplitude_yaw_dumbbell 
## delete due to too many missing values: var_accel_dumbbell 
## delete due to too many missing values: avg_roll_dumbbell 
## delete due to too many missing values: stddev_roll_dumbbell 
## delete due to too many missing values: var_roll_dumbbell 
## delete due to too many missing values: avg_pitch_dumbbell 
## delete due to too many missing values: stddev_pitch_dumbbell 
## delete due to too many missing values: var_pitch_dumbbell 
## delete due to too many missing values: avg_yaw_dumbbell 
## delete due to too many missing values: stddev_yaw_dumbbell 
## delete due to too many missing values: var_yaw_dumbbell 
## delete due to too many missing values: kurtosis_roll_forearm 
## delete due to too many missing values: kurtosis_picth_forearm 
## delete due to too many missing values: kurtosis_yaw_forearm 
## delete due to too many missing values: skewness_roll_forearm 
## delete due to too many missing values: skewness_pitch_forearm 
## delete due to too many missing values: skewness_yaw_forearm 
## delete due to too many missing values: max_roll_forearm 
## delete due to too many missing values: max_picth_forearm 
## delete due to too many missing values: max_yaw_forearm 
## delete due to too many missing values: min_roll_forearm 
## delete due to too many missing values: min_pitch_forearm 
## delete due to too many missing values: min_yaw_forearm 
## delete due to too many missing values: amplitude_roll_forearm 
## delete due to too many missing values: amplitude_pitch_forearm 
## delete due to too many missing values: amplitude_yaw_forearm 
## delete due to too many missing values: var_accel_forearm 
## delete due to too many missing values: avg_roll_forearm 
## delete due to too many missing values: stddev_roll_forearm 
## delete due to too many missing values: var_roll_forearm 
## delete due to too many missing values: avg_pitch_forearm 
## delete due to too many missing values: stddev_pitch_forearm 
## delete due to too many missing values: var_pitch_forearm 
## delete due to too many missing values: avg_yaw_forearm 
## delete due to too many missing values: stddev_yaw_forearm 
## delete due to too many missing values: var_yaw_forearm
</code></pre>

<pre><code class="r">trainingset &lt;- trainingset[,!names(trainingset) %in% toBeDeleted]
testset &lt;- testset[,!names(testset) %in% toBeDeleted]
validationset &lt;- validationset[,!names(validationset) %in% toBeDeleted]


#summary(trainingset) # no missing values left

# check variable types
#str(trainingset) # correct

# delete due to theoretical reasons: row number and username etc won&#39;t explain useful variance. so exclude from model
trainingset &lt;- trainingset[,-c(1:7)]
testset &lt;- testset[,-c(1:7)]
validationset&lt;- validationset[,-c(1:7)]

# delete variables with near zero variance
nearZeroVar(trainingset[,-53], saveMetrics = TRUE) # no variables with NZV
</code></pre>

<pre><code>##                      freqRatio percentUnique zeroVar   nzv
## roll_belt                1.080        8.1744   FALSE FALSE
## pitch_belt               1.046       12.4836   FALSE FALSE
## yaw_belt                 1.081       12.9422   FALSE FALSE
## total_accel_belt         1.079        0.2111   FALSE FALSE
## gyros_belt_x             1.055        0.9390   FALSE FALSE
## gyros_belt_y             1.156        0.5023   FALSE FALSE
## gyros_belt_z             1.109        1.1865   FALSE FALSE
## accel_belt_x             1.011        1.1647   FALSE FALSE
## accel_belt_y             1.108        1.0118   FALSE FALSE
## accel_belt_z             1.071        2.1328   FALSE FALSE
## magnet_belt_x            1.116        2.2492   FALSE FALSE
## magnet_belt_y            1.139        2.0309   FALSE FALSE
## magnet_belt_z            1.057        3.2319   FALSE FALSE
## roll_arm                56.163       17.4334   FALSE FALSE
## pitch_arm               96.640       20.0830   FALSE FALSE
## yaw_arm                 30.570       19.1731   FALSE FALSE
## total_accel_arm          1.013        0.4731   FALSE FALSE
## gyros_arm_x              1.000        4.6004   FALSE FALSE
## gyros_arm_y              1.510        2.6714   FALSE FALSE
## gyros_arm_z              1.097        1.7251   FALSE FALSE
## accel_arm_x              1.050        5.5612   FALSE FALSE
## accel_arm_y              1.215        3.8579   FALSE FALSE
## accel_arm_z              1.033        5.6122   FALSE FALSE
## magnet_arm_x             1.050        9.5865   FALSE FALSE
## magnet_arm_y             1.065        6.2527   FALSE FALSE
## magnet_arm_z             1.062        9.0843   FALSE FALSE
## roll_dumbbell            1.055       86.4900   FALSE FALSE
## pitch_dumbbell           2.333       84.2117   FALSE FALSE
## yaw_dumbbell             1.079       85.8931   FALSE FALSE
## total_accel_dumbbell     1.073        0.2984   FALSE FALSE
## gyros_dumbbell_x         1.014        1.7106   FALSE FALSE
## gyros_dumbbell_y         1.268        1.9726   FALSE FALSE
## gyros_dumbbell_z         1.002        1.4194   FALSE FALSE
## accel_dumbbell_x         1.043        2.9771   FALSE FALSE
## accel_dumbbell_y         1.006        3.3047   FALSE FALSE
## accel_dumbbell_z         1.195        2.9189   FALSE FALSE
## magnet_dumbbell_x        1.089        7.7231   FALSE FALSE
## magnet_dumbbell_y        1.238        6.0125   FALSE FALSE
## magnet_dumbbell_z        1.240        4.8479   FALSE FALSE
## roll_forearm            11.386       13.7138   FALSE FALSE
## pitch_forearm           58.391       19.1294   FALSE FALSE
## yaw_forearm             14.137       12.9058   FALSE FALSE
## total_accel_forearm      1.108        0.4950   FALSE FALSE
## gyros_forearm_x          1.013        2.0745   FALSE FALSE
## gyros_forearm_y          1.035        5.2919   FALSE FALSE
## gyros_forearm_z          1.086        2.1109   FALSE FALSE
## accel_forearm_x          1.136        5.6850   FALSE FALSE
## accel_forearm_y          1.097        7.1481   FALSE FALSE
## accel_forearm_z          1.061        4.1272   FALSE FALSE
## magnet_forearm_x         1.109       10.6129   FALSE FALSE
## magnet_forearm_y         1.140       13.3935   FALSE FALSE
## magnet_forearm_z         1.023       11.7266   FALSE FALSE
</code></pre>

<pre><code class="r"># plot histograms
for (col in 1:(ncol(trainingset) -1)){
  #hist(as.numeric(trainingset[,col]))
  if (col != ncol(trainingset) -1){
    #readline(&quot;Please press the Enter&quot;)
  }
} # few highly skewed, few with two normal distributions (1 - 4, 10), few with many zero variables

# investigate double distributions further
#featurePlot(x=trainingset[,c(1:4,10)], y = trainingset$classe, plot = &#39;pairs&#39;)

correlations &lt;- abs(cor(trainingset[,c(1:4,10)]))
diag(correlations) &lt;- 0
which(correlations &gt; 0.7, arr.ind = T) # plots and correlation table shows high correlations -&gt; need for PCA as preprocessing proces
</code></pre>

<pre><code>##                  row col
## yaw_belt           3   1
## total_accel_belt   4   1
## accel_belt_z       5   1
## roll_belt          1   3
## total_accel_belt   4   3
## accel_belt_z       5   3
## roll_belt          1   4
## yaw_belt           3   4
## accel_belt_z       5   4
## roll_belt          1   5
## yaw_belt           3   5
## total_accel_belt   4   5
</code></pre>

<p>The data preparation stage suggested non-linear effects, therefore no regression are used to model the data. Instead, a decision tree and a random forest model are trained. I expect the random forest to perform better than the decision tree. As random forest generally overfit less than decision trees. I expect random forest to perfom pretty well.</p>

<pre><code class="r"># ---- build models ---- #
# -- trees
modelFitTree &lt;- train(trainingset$classe ~., method=&#39;rpart&#39;, data = trainingset[,-53])
finalModelTree &lt;- modelFitTree$finalModel
modelFitTree
</code></pre>

<pre><code>## CART 
## 
## 13738 samples
##    51 predictors
##     5 classes: &#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39; 
## 
## No pre-processing
## Resampling: Bootstrapped (25 reps) 
## 
## Summary of sample sizes: 13738, 13738, 13738, 13738, 13738, 13738, ... 
## 
## Resampling results across tuning parameters:
## 
##   cp    Accuracy  Kappa  Accuracy SD  Kappa SD
##   0.04  0.5       0.4    0.02         0.02    
##   0.06  0.4       0.3    0.07         0.1     
##   0.1   0.3       0.05   0.04         0.06    
## 
## Accuracy was used to select the optimal model using  the largest value.
## The final value used for the model was cp = 0.04.
</code></pre>

<pre><code class="r">finalModelTree
</code></pre>

<pre><code>## n= 13738 
## 
## node), split, n, loss, yval, (yprob)
##       * denotes terminal node
## 
##  1) root 13738 9843 A (0.28 0.19 0.17 0.16 0.18)  
##    2) roll_belt&lt; 130.5 12597 8713 A (0.31 0.21 0.19 0.18 0.11)  
##      4) pitch_forearm&lt; -33.95 1133    7 A (0.99 0.0062 0 0 0) *
##      5) pitch_forearm&gt;=-33.95 11464 8706 A (0.24 0.23 0.21 0.2 0.12)  
##       10) magnet_dumbbell_y&lt; 439.5 9677 6973 A (0.28 0.18 0.24 0.19 0.11)  
##         20) roll_forearm&lt; 124.5 6008 3578 A (0.4 0.18 0.18 0.17 0.064) *
##         21) roll_forearm&gt;=124.5 3669 2449 C (0.075 0.18 0.33 0.23 0.18) *
##       11) magnet_dumbbell_y&gt;=439.5 1787  868 B (0.03 0.51 0.041 0.23 0.19) *
##    3) roll_belt&gt;=130.5 1141   11 E (0.0096 0 0 0 0.99) *
</code></pre>

<pre><code class="r">fancyRpartPlot(finalModelTree)
</code></pre>

<pre><code>## Loading required package: RColorBrewer
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAIAAAApSmgoAAAABnRSTlMA/QD+AP2iVEMGAAAACXBIWXMAAAsSAAALEgHS3X78AAAgAElEQVR4nO3df3BT57kv+kd2Q3aOfLy3G3dyjZMirB8bXJfZQ6dpLTkJmPDDdiAkN+O2KQkJAzIJ29jsYpjh0A731M0MNt1IcEmwYUhIKGk93eAELDl2IocUy5R9mrOHeLscS7JFg8PN1K1PudbNhIy97h9LkpeltWTZSFryo+9nmGRJetdar15rffXq1XqXNBOTEwQAAHxlqV0BAABILgQ9AABzCHoAAOYQ9AAAzCHoAQCYQ9ADADCHoAcAYA5BDwDAHIIeAIA5BD0AAHMIegAA5hD0AADMIegBAJhD0AMAMIegBwBgDkEPAMAcgh4AgDkEPQAAcwh6AADmEPQAAMwh6AEAmEPQAwAwh6AHAGAOQQ8AwByCHgCAOQQ9AABzCHoAAOYQ9AAAzCHoAQCYQ9ADADCHoAcAYA5BDwDAHIIeAIA5BD0AAHMIegAA5hD0AADMIegBAJhD0AMAMIegBwBgDkEPAMAcgh4AgDkEPQAAcwh6AADmEPQAAMwh6AEAmEPQAwAwh6AHAGAOQQ8AwByCHgCAOQQ9AABzCHoAAOYQ9AAAzCHoAQCYQ9ADADCHoAcAYA5BDwDAHIIeAIA5BD0AAHMIegAA5hD0AADMIegBAJhD0AMAMIegBwBg7mtqVwAg02VnZcvePzE5keKaAFcIegD1CYIQcY9Goxn765j0Hq1Wu+DeBSmsFPCBoAdIG84aTftGoaVCvDU0NBR+JD8/X6vVqlQtmPcQ9ABpwlnTTrZiY/j2+Ph4eDk/P1+NKgET+DIWIE1UtDQUk8mgdjWAIQQ9QLrwdgyQceZiALOlwTf7ALEpnRUz3+HYzxwYowdQJEb8SMCvdkWSQnx2X3zxBRHhfB7e0KMHkJedlc014qUKtTrx9J6CggJC4jOFoAeQkSEpLyrU6q5evUpERUVFhBP2OcKXsQDpwXdqg/bpEz4V9jwS8D/88MNENDQ0dPv27UAgoEIlIJkQ9ABpwd95cemWJRc6b6hVgfHx8fHx8dHRUSK68+UdtaoByYCgB0gHN7rPLVl7dPXScx/41a7K0NAQOvXM4KwbgDTQ1XLgylnSniUi6tpycI1qFRkfH8/JyVFt95Ac6NEDqM914eym8/6RgH/k/LNnLvSoXR3gBkEPoDbfKdvAz14Se/FrVm861e1SuULADYZuANSm3/LuB+EbKw8GVqpYF2AJPXoAAOYQ9AAAzCHoAQCYQ9ADzJLv1AatrlCcxRpc1m04pjTRqWdvbY9krX3KX7QGS7pqdYVaXaFWV1irdPpNxDZ1e7tm2GYc9QTOEPQAs+OyXVx/zT9yfskBW4+/8+LS8/6RwKX11+UmOvlObdC+eEa61jWDTTa+JSXLj/pHAv7epuWb1st9Kxu9zYBf/rx7SckZ6gncIegBZqf86LlteiKiTetX6nacW3tBV6jdRfVbdNFF9VveDby+KZ6NRpbsee16rXx8T5W84RugC9bQZ4uY25yhnsAdgh5gDnr2Xlh9cA25anXvrfePBA6TNcaYDBFR+folB5bpCq0X49m6/9hRku3OR1nf6h8J1HptM8yxir+ewBKCHmC2evZqu9ceFYN4uUEv3nndF/vCk2teGQn4R/YuoSVFM+5g6PqStTNfBWGRvnjmuobEXU/gCEEPELeufXu7yFX74hk6+5xWV1jbU17/xIVlukLtYxeePrxNH1lSyn/s6UKtrvApqt+xKHqb093wkUHm3SCqZGjvRw31K+MrGVVPyAz44REAGRn1wyNEVKjVuVzBQZ2cnJyioqK8r+epWyVIIPToAQCYQ9ADADCHoAcAYA5BDwDAHIIeIPVCVyagnr1T1zCQLHftC18CwX9snyq/GA6cIOgBUkt6ZYJjR+m8fyTwOh085ZIue+jANf9b1O2inm6qwQmRcJcQ9ACpJbkyQWhi1Mq1xd73JMtkpAPLdM/R6qJjw/qI8+4BZg9BD5B+xGm0R6mbVlFt7OtTAswMQQ+gmqIl19/rIqKe9wYMayXL4rRY/7Fh/Y6h9+j1kWs/I08SLy8snS0FLOE3YwFkTExOpGByrG5HLWl1hUSbzvvL1yx+L7SsIyLfqddo1UFaRKQrXEabzm9JUh2Q8pkAl0AAkHfnyzv33XcfEXG9FkKhVkdE0SmPSyDwgx49gKKhoaHR0VExEPlBRz5zoEcPIO/Ol3cCgcDQ0ND4+LhsgZUr47pkvLp6ema4VH0EsTtPROjRc4IePWSu7KzsWZVn0wUuLy+PvzD6ggwg6CFDiSkvCEKc5TUaTTKrkzpiys/qiSPr5zv8CSFDZWdlxx92RKTRaEZHR6X33H///YmuVJCzpoZaWioSsam//OUvEffk5+fP9okjJeY7nEcPEK+8r+dJ/8Uu7LVbLHav+N9pDzhrNDXOGKuQ197YGkdtnDUacUNeu0Wj0Wgsdu/0Zbk6Y+Q9MyHoAe5KMFo1Nc7wYmS0R+lvtARXiY5mj31zvZtaK2XeHyRvEM4aSzuZxcXmerJ5HFZ3W4dXXPbYqK1jhipINxuqS9S7BHCBoIdp30lm2jJ57TV2LxF57ZYap0zfOCL25L+/Nds8QovRvrm+xCEIgqOkfvMMWVl9WhAc1tZGu9fZXF/iEDw2qm8WU9xYd9pmJqujt84QrKBYp8EGQZgazalo6W0oDi0KvabmSnL01tFgP5WYDETkHvBI96f4tbN3kGweQfDYislr3zywXxAET/WA4rtEOvzJVHupzGcI+owmvo6lI7CZtkwGEw14yGtvptMNg5vr3URE7rYOL3kG3GR1CEIocGXWDSsxGYg8A25zsZGIjMXmiJyVLW8sNrsHOgb7qbVSY6x3U/9gzHViqmjxFDdqajqUHlcaZPd2DBRXGcjbMUBGz0DJxgoi8gyQySBbOj3+ZKq9VOYzBH1GY/M6viv97TXN1FBn8AyUOARBEMRwr2gRPMWNGqXx9GjhfA8nvqLWdmewWJWphKwOwWMzU4lJdh1DXa8gCEKvqVmhLs6a8KcOk6mE+ge9RDRDBUKCoe4ZIJOhYiNVajQaTWNxQ0K+BoY0gtMrIcMZi6mfGloMRIaNwXMorQ6hYdBirHcTkbk6rsQkIkPdaZvFqNEQmW2eFgPZlYua+xs1GjdZHYKhwmtrNGqMZHUIFWRvJCIymEqovtJS7Jn2YaKiReFUmYoGW6PRaCSzzVNRQeFlpU759HVbWiT/axGEljifLMwvOHEKMtQchl8jDpYszTz4QDwpTEbcc/dPPHNkZ2XzeO4I+ozG5nWc1nxHyoy7+oI3tnVMHl+nanUgAyHoAQCYmwefPQEA4G4g6AEA5OE8euCAzesYIBnYjGxjjB4AgDn06AEAmEPQAwDIYzO2iaDPaGxexwDJwGZkG2P0AADMoUcPAMAcgh4AQB6bsU0EfUZj8zoGSAY2I9sYowcAYA49egAA5hD0AADy2IxtIugzGpvXMUAysBnZxhg9AABz6NEDADCHoAcAkMdmbBNBn9HYvI4BkoHNyDbG6AEAmEOPHgCAOQQ9AIA8NmObCPqMxuZ1DJAMbEa2MUYPAMDc19SuAKhAqSOPd30AlhD0GUoQhIh7NBrNnS/vSO9ZcO+CFNYIIO1kZ2Xz6P0g6GHKrVu3wsu5ubkIeshwPFKe8GVs5vLaLRqNRqOpcU7d5w8ZHR1Vr2YAkGAI+kxlqOsVBI/NWmxUuyYAkGQYuslczhpNY7Gn16B2PQDSFZsxevToM5TXbqlsJXdbh1ftmgCkLR4pTziPPt2wn8GE1xtA6mHoJo1kZ2WPBPxq1yK5xHcy8cterVaLE3sAUgA9+nSRCSkfVqjVDQ0NEVFBQQHhhH1IVxijh0TKqJQX+f1+Irp161YgEIiYqAWQJnikPCHoM5fv1Abt0yd8alZBPGH/9u3bgUBAzXoAcIegz1D+zotLtyy50HlD3WqMj4+LWY9OPUDyIOgz043uc0vWHl299NwHfrWrMj4+rnYVAOSxOQsOZ91kpK6WA1fOkvYsEVHXloNr1K4PQFrCGD3MY64LZzed948E/CPnnz1zoUft6gBAciHoM4/vlG3gZy+Jvfg1qzed6napXCEASC4M3WQe/ZZ3PwjfWHkwsFLFugCkM5xHDwDAHI+UJwQ9AAB7CHoAAOYQ9Gmva1+hVlc4NYu1Z2+twnkyvlMb4iwpfTS41j7lr2QjSuo2HFOaZiXdY+y9A8wDbM6jR9CnO7++ZiTgHzm/xOsTo/bFMwolXbaL66/5R84vOWDriV1S+mhwrWsGm2wuS0r6Oy8uPe8fCVxaf11umpV0j7H3DjBPYIweUkSnX0Rd+wqforVriPRb3g28vkmhZPnRc9v0RESb1q+MXXKGRxVK6nacW3tBV6jdRfVbdLG3Gf/2ASD5EPTzwZpXFHvckXr2Xlg9q5mu5euXHFimK7RenLGkq1b33nr/SOAwWWOM8wBA2kHQpztX7dMnfET6xUtnLtuzV9u99ugsz4tf88pIwD+ydwktKZqp6HKDXly47lP1spcAqYExeki+rn17u6i8/okLy3SF2qOGeuUE79q3t4tctS+eobPPaXWFMfr+Xfv2dk27w3/s6UKtrvApqt+xKHbJUE0eu/D04W36WCUBeGAzRo9fmEoLmfbDI4Vancs1Nfyj0+kKCgrwO1MASYIePQAAcwh6AAB5GKMHAGCOzcg2gj4zSKe/SifQitNua3uIyH9sn7o/IQsASYLLFGcEcfrru3RqQ20P0cX11/zv+vYV2npWL6ED1/x62z4XkY9qpp1LAwBcoEefcaQTaHVGOrBM9xytLjo2rI84vRIg42GMHuaTqOmvoQm04mypo9RNq6hWV6jV4Yx4gDCM0UMiTUxOFGp1SdzBtOmvkRNo/ceG9TuG3qPXR679jDxKV6YEgPkKQZ8ukpr10umvkRNofadeo1XltHItvVi47L+TMbkDOIVaXcRsKQBINsyMTSNjfx3Lz89nPEVWKeIxMxbSE5vfjMVZN+nl6tWryR3DURU68jC/8Eh5QtCnm6KioqtXr46Pj6tdkdTJyclRuwoAzCHo08j9998f/i9jPT1TF9cUUz43N1e96gDwhy9jQTViyhcVFWm1WgzQQxpicx49evTzhrOmhlpaKtSuxt3T6XTh5YKCAiJCykN6YjNGjx59uvPaLRa7l7z2xtaox5w1mhqn4moajUbx4WQK7tpi94q3nTVTy0REBRIL7l2AlAdINgR9+nHWaCyW6THtsW+ud1NrpcXujYjR/ka5QPfaN9e7ichcbAzlrrhG6EaNU7qdqXunFu12S6gWdrtFGtzSisq8kzib68nmcVjdbR1eIpl3KDHcEfEAKcMk6MNDadIxtfm4HFJ9WhAc1tbGYLga607bzGR19NZ5muvJ5hEcJfXNzlBJj83c2j4tcA3h8mTfXF/iEATBUVK/Wdya2eYRWqi5vsQheGxU3+x0NteXOASHlfoHpwpUEblL9gsem7m1jU4L4eCmqS77YIMgRI8lVbQIvabmSnL01hmInM1tZI56eqlpzFT9sYAtNn9uJkEfHkqTjqnNx+WgEpOByFhsdg94pj/gHeynEpOBKlqCEVtiMpDBVBK5gTDPgNtcbCTp1kpMBvIO9lNrpcZY76b+QWODrb9SUxnueJeYDEQkfh6Q3o5p2ieNihZPcaOmxum1N9L+/Uq1S4cGn/MymwiAGDBGD8nU2u6UZLSEwVRC/YPeqHFvReF8n741g6mErA7BYzNTCXVsDvbo42So6xUEQeg1NUuGbkJ31nmmqjbY0eZuraxsJXfo0wQfbCIAMgHOuklL5v5GjcZNVodgIDsRiclcX2kp9py2kdGoIfGxmhm3ZKg7bbMYNRois83TEtoaUUWDrdGoMZLVIdRRTX19pabfbHaTh4rjr2VFiyDI3NtgazQajWS2eerqDHV15KzRNBafrovjUwEAJAWTa93wuCRFliaLiMhZo2nfKDP4zcWkMKl2FQDiwiNYiM3QDY8/xqQwOSlMTgoCkRBajvuf12bWhFkds109hf/UbubEwBh9JuARLMSmRw8AAEqY9OgBAEAJk6DH52gASDg2wYKhG4C5YPM1HWQCBD0AAHNMhm4AAEAJk6BnM5QGAOmDTbBg6AZgLjBGD/MIgh4AgDkmQzcAAKCESdCzGUoDgPTBJlgwdAMwFxijh3kEQQ8AwByToRsAAFDCJOjZDKUBQPpgEywYugGYC4zRwzyCoAcAYI7J0A0AAChhEvRshtIAIH2wCRYM3QDMBcboYR5B0AMAMMdk6AYAAJQwCXo2Q2kAkD7YBAuGbgDmAmP0MI8g6AEAmPua2hUAmE9kP8ujtwRpDmP0APHKzsoWoqhdKUgiNsHCpEePLhWoaOyvY9KbWq12wb0L1KoMJBCbYGHSowdIIa/dotFoNDXO4O1rErdv31a1bgAyEPQAs+TtaHMTkXVjhdo1AYgPk6BnM5QG84ChrlcQBAe1O2cuC/Mam2BhEvRshtJgHnDWaDQaTWNxA3r03LEJFpxHD3yw6X9FwEEKd4nJWTeQ4cSIHwn41a5IUojP7osvvgjfg7N6YFaY9OgxHz2TZWdlc414qUKtbmhoiIhyc3OJKO/reWrXiD82wcIk6CFjZUjKiwq1uqtXrxJRUVER4YR9iBuTL2MBUsd3aoP26RM+FfY8EvA//PDD4+Pj4gn7gUBAhUrAPISgB5gdf+fFpVuWXOi8oW41RkdHKWpSLoAsJkHP9XQLSD83us8tWXt09dJzH/jVroo4ZA/JwyZYmJx1g28aIEW6Wg5cOUvas0REXVsOrlGtIuPj4zk5OartPjOwCRYmPXqA1HBdOLvpvH8k4B85/+yZCz1qVwcgLgh6gLj5TtkGfvaS2Itfs3rTqW6XyhUCiAuToRs2p7tCWtNvefeD8I2VBwMrVawLpACbYGHSo+fxxwCAtMImWJgEPQAAKEHQAwAwxyTo2ZzuConkO7VBqyucmsV648SqffJfn0pLdu0rnLZW7G327K1VOPdmWsmevVpdoVa3t0uprqHtRG4f1MQmWJgEPZuhNEggl+3i+mv+kfNLDth6iMRT4Gcu6dfXjAT8I+eXeOWidto2fac2aF88E8fe/ceO0nn/SOB1OnjKH11Usp3IOoOq2AQLk6AHiFZ+9Nw2PRHRpvUriW6cuGA4sGXmkjr9IuraV/gUrZWbDDVtm/ot7wZe3xTH3oeuL1m7hohWri32ykxmlWxnep0BEgNBD7z17L2w+uAaoq4W7/ot+nhKEtGaV0auGWxKYzLSknHufXbmthaAIiZBz2YoDRKqZ6+2e+3RlUTk91w/85TuuVNnn5OP76mSrtqnT/iI9IuXzrTN+PdetOT6e11E1PPegKEo7rVAdWyChUnQsxlKg8To2re3i1y1L56hs89pdYW1Pbod50YC/re2PPtWRIZGlSyvf+LCMl2h9qihfoaSs9l7LT2lK9S+SHu36KJKSsW1fUgVNsGCHx6B+S2jfniEiAq1OpcreOpQTk5OUVERfmoKZsSkRw8AAEqYBD2boTQASB9sgoVJ0GMACgASjk2wMAl6gGQJTlXVbTh2Y9qkWXG5toeI/Mf2YSIrpDMEPUAs/s6LS8/7RwKX1l//wCWZNOv30IFr/reo20U93VSzLeYp+gDqYhL0bIbSIN3odpxbe0FXqN1F9VvKJZNmdUY6sEz3HK0uOjas37FI7WpCUrAJFiZBz2YoDdKNq1b33nr/SOAwWfe5SDJpds0rIwH/yFHqplVUG/uCZTBfsQkWJkEPkDTLDcFhmeu2VZGTZv3HhvU7ht6j10eu/Yw8N5JdFelJ9ADxQ9ADxBKaKPvYhacPv9s6fdKs79RrtKqcVq6lFwuX/XcyYgAH0hSTmbFsftoR5iBDJsdGd+cxMzbZ2AQLkx8H5/HHgLn54osv7rvvPnGZX+IXanXiAgZtUo9NsDAJeshwQ0NDo6Oj4+Pj4VhkQynfc3JyUlwTmL+YDN0AV1kafI00C5PCpNpVgHTE5Chic7orAKQPNsHCJOjxuQQAEo5NsDAJeoBZcdbUONWuA0DKIOgh83jtja2KDzprNBa7N67tOGs00veLiJvTdmix2L3if2dVU7lKhZa9dotGo4m7spDJmAQ9m6E0UOK1WywWi0aj0dTY7ZZQwAXDTgxYZ41Go9FYLBaNxe4lZ40muEJELHrtm+vd1FoZmZDi6prK1tCt0EZrnAp7J6L+Rkt4/xE3Zw5iMbKj3x+cNZppd0nfmMLLzuZ6snk8NmrrQNInC5tgYRL0bIbSuAofMNIjJ55lKXfJfsFjM7e20WnBYXW3dXidzfUlDsFhpf5Br9fe2Gp1CMLp6qk1qk8LHpvZPeAhsaTHRvXNnrrTNjNZHb11BsnGQ6t7bGb5pxC999AuBIe1tdEeeVOyR6VRooqNVveAh8hcbAzWQXxrGGwQhJaKcDFncxuZI5e9g/1UYjIQkXvAE7Hd2TYymzhLODbBwiToIc2FDxjpkRPPslQoD8V8IyKqaLD1Vwb74J4Bt7nYSGQwlYRWKDEZgje9g/3UWqkx1rupf1C2Ayyz+kx7D98yFpuDaTt1s0O6x8gkDqnYaG1tb4/YZASvvZH27y+JWo5hto3MJs5ACYIe5i+PfXOwR09Taesd7I8uaTCVkNUheGxmpVSVWb1/0Cu/NYnWdufUm4T0ZpV0j0al1Ss2Wltb+4NvIWSo6xUEQeg1NU8N3Xg72tytlZWt5K7fXNM8tdxBJcH3rNA7EIAiJjNj2VySAmbDaCqh+kpNv9nsJo+hZb9VU6lptVqtMkUrGmyNRo2RrA6hgohKqL7SUuyRjN4Y6sTVzWZxlMRYbHbXGzVtZjPF6kGb+xs1GjdZHYKBnNNuVngle7Q3Kj2FYjNR5FtPRYsgTNWrV6gjZ42msfh0S52hpSW4XFdH1GY0Gsls88T4PBAvHEGy2DQLZsZCKqTggPHZy0x/3D9xfF3n9uz2JyeOV8y8ShrwHbFspjcv78QPVEEyYegGUiEF/Ql93f5trVXZWdlVrds2xpPyviNlWdnZwX/bO5NdP5mdlpVZTLuougopD0mGHj0AAHNMevQ4PwzgbuAIksWmWdCjh1Rg86UWwHyEoAcAYI7J0A0AAChhEvRshtIAVIEjSBabZsHQDaQCxugBVISgBwBgjsnQDQAAKGES9GyG0gBUgSNIFptmwdANpALG6AFUhKAHAGCOydANAAAoYRL0bIbSAFSBI0gWm2bB0A2kAsboAVSEoAcAYI7J0A0AAChhEvRshtIAVIEjSBabZsHQDaQCxugBVISgBwBgjsnQDQAAKGES9GyG0gBUgSNIFptmwdANpALG6AFUhKAHAGCOydANAAAo+ZraFUgMjAykmxkHN/H3Sis4gmSxaRYM3UBSZGdlC4Kg9KhGoxkdHZXeo9VqF9y7IPn1AshETHr0MO8MDQ2Fl/Pz87VarYqVAeANY/SQZM4aTY2TyFmj0Wg0mhpn8O5xCVXrB8Afk6Bnc7orO86adrIVG7329mKPIHhsxWpXCGThCJLFplmYBD2+aUhXFS0NxWQyEBWbDEQeIqPaNQI5OIJksWkWfBmbudj0VqLhVQ0ghS9jM1R2VvZIwK92LZKFzVlxAAnBpEePA3tWeKe8qFCrGxoays3NJSLxlB6cvhkDjiBZbJqFSdBD/DIh5UWFWt3Vq1fz8/OJqKCggJD1kKkwdJNZMiflReLpmzk5OURUUFBw58s7yHrIQEzOuoH05Tu1Qfv0CZ8Kex4J+MvLy4lofHx8dHT01q1bKlQCIA0wCXrGJ5DMd/7Oi0u3LLnQeUPdaojTsgKBgLrVSFs4gmSxaRYmQY9vGtLVje5zS9YeXb303Ad+tasiXl3nzpd31K5IOsIRJItNs2CMHpKpq+XAlbOkPUtE1LXl4Bo16zI+Pn779m1cVAcyEJMePaQn14Wzm877RwL+kfPPnrnQo3Z1ADIUk6BnM5TGiu+UbeBnL4m9+DWrN53qdqlcIVCEI0gWm2bBefSZJdNOryzU6lyuqfcXnU5XUFCAMywh0zDp0QMAgBIEPQAAc0yCns1QGoAqcATJYtMsTIIe3zQkgO/UBq2uUJzFGlzWbTimNNGpZ29tj2QthZLSbRIR3Tixap/yV7IR24yjZOQyzBGOIFlsmoVJ0MPdc9kurr/mHzm/5ICtx995cel5/0jg0vrrchOdfKc2aF88Q0TixFflktJtEomn1SvsXrLN4FrXDDbZBJeUnLYMAAoQ9BBUfvTcNj0R0ab1K3U7zq29oCvU7qL6Lbroovot7wZe30RERLFLSrdJdOPEBcOBLQq7l2xzBtKS8a8FkMGYBD2boTS19ey9sPrgGnLV6t5b7x8JHCZrjPETIoqnZHCb1NXiXb9FH0clytcvObBMV2i9OPv6wxzhCJLFplmYBD2boTRV9ezVdq89upKIiJYbgpF83TfDhSdjl5zapt9z/cxTuudOnX1uxiH1Na+MBPwje5fQkqJZPQGYMxxBstg0C5Ogh7vStW9vF7lqXzxDZ5/T6gpre8rrn7iwTFeofezC04e36SNLSsUuKd2mbse5kYD/rS3PvhV8L1Hcpv/Y04VaXeFTVL9jUeySABAPzIzNLJgZi5mxkIGY9OjZDKUBqAJHkCw2zcIk6PG5BOBu4AiSxaZZmAQ9AAAoQdBDIrlqdYVaXaFWV1jbQ9SzV6sr1Or2dhF17QvdSf5j+1T5CVmAjMUk6NkMpc135Uf9IwF/b9PyTetX+o8dpfP+kcDrdPCUy0MHrvnfom4X9XRTzbZ4TqeHFMIRJItNszAJejZDaSz0vHa99uAaGrq+ZO0aIlq5tthLRjqwTPccrS46NqyPOGkS0gCOIFlsmoVJ0EP68B87SutXRt4rzoE6St20impD4zkAkBII+swyMTlRqNUldRehjjwVLbn+XhcR9bw3YBBnuPqPDet3DL1Hr49c+xl5lK6LmTARJ9EDZKyvqV2BxMjOymbzIdNhn3UAABzvSURBVCvZJiYnkjlt6oaPDKuJiEi3o5a0ukKiTef9OiLynXqNVh2kRUS6wmW06bzS5c0SAyk/KziCZLFpFsyMzURjfx3Lz89nPEVWNuVzcnLy8/MxMxYyEJMePczW1atXkz2GoyKlvnxubm6KawKQDhD0GSo/P9/lcq1cGfWt6TzX06N4acz8/HwiQnceMhCTL2PZnO6aGlqtloh0Op3aFUkd8cmKTxyi4QiSxaZZmAQ9vmmYlQX3LigoKFC7FqmQk5OTk5MjpnyGPOW5wREki02z4MvYDHXnyztE9Hd/93dqVyTBhoeHI+4Rx+XFvjzGbSAzMenRw2wtuHfBjKnntVssdq/438gHNBqNpsaZxApGcdYE9xjce3j3zhrNVAUX6RZF/Mv7el7e1/Pieb4AXDEJejZDaaqQJGdoMTLapxffXO8mInOxcXr5qe0ElyLunVq02y0WiyW0KLu/cK4Hb1naySwuNteTzeOxmVvbxdhvbE1Cm2QaHEGy2DQLk6DHAJQs6ctUaTnIbPMILUb75voShyAIjpL6zYpRb6g7bTOT1dFbR9HlzTaP0ELN9SUOwWOj+mans7m+xCE4rNQ/OFWgishdsl/w2MytbXRacFjdbR3B3YXeIwYbBKGlIrTPipbehuLQotBbZ/AMuM3FRiJnc1vwDWCOTxyICEeQAjbNwiToQZb0Zaq0HFRiMhCF0pOMxWb3gGfG7cuULzEZyDvYT62VGmO9m/oHjQ22/kpNZbjXXWIyEJH4eUB6e1acNZWt1v11Bq+9kfbvL4l6fBZPHCADIOhhSjivwwk+p/IGUwlZHYLHZqYS6tgc7NHHyVDXKwiC0GtqVvoSwGu3VPbbPC0V5O1oc7dWVraSO8YHEABgMmGKzSUpEmu2zWKoO22zGDUaIrPN02Ig+xzLVzTYGo0aI1kdQh3V1NdXavrNZjd5qDj+ulS0CILsA87mejeR26iptzqEXqGOnDWaxuLTdXF+MMBLRRaaRRabZsHplRktS8PtI92kMKl2FQDSDrfjHGZlUpiM65/XZtaEWR1xrqXGP7VbFCAdoUcPAMAckx49TpuThWaJhjaRhWaRxaZZ0KMHAGCOSY8eAACUIOgBAJhjEvRshtISC80SDW0iC80ii02zYIweAIA5Jj16AABQgqAHAGCOSdCzGUpLLDRLNLSJLDSLLDbNgjF6AADmmPToAQBACYIeAIA5JkHPZigtsdAs0dAmstAsstg0C8boAQCYY9KjBwAAJQh6AADmmAQ9m6G0xEKzREObyEKzyGLTLBijBwBgjkmPHgAAlCDoAQCYYxL0bIbSEgvNEg1tIgvNIotNs2CMHgCAOSY9egAAUIKgBwBgjknQsxlKSyw0SzS0iSw0iyw2zYIxegAA5pj06AEAQAmCHgCAOSZBz2YoLbHQLNHQJrLQLLLYNAvG6AEAmGPSowcAACUIegAA5pgEPZuhtMRCs0RDm8hCs8hi0ywYowcAYI5Jjx4AAJQg6AEAmGMS9GyG0hILzRINbSILzSKLTbNgjB4AgDkmPXoAAFCCoAcAYI5J0LMZSkssNEs0tIksNIssNs2CMXoAAOaY9OgBAEAJgh4AgDkmQc9mKC2x0CzR0Cay0Cyy2DQLxugBAJhj0qMHAAAlCHoAAOaYBD2bobTEQrNEQ5vIQrPIYtMsGKMHAGCOSY8eAACUIOgBAJhjEvRshtISC80SDW0iC80ii02zYIweAIA5Jj16AABQ8jW1KzB3MT5VZebHlHg+ZmZgy6BZZKFZlLAMlnkc9EQkCEL0nRqNZuyvY+GbWq12wb0LUlgpNck2SFhEyxBR3tfzklyjtDCrZsmcFwyaRQm/YJnfQa9kaGhIXMjPzyeiefT3SLZwyxBRfn7+/HqxJo+0WYqKitAmIhxHEebv64THGL2zRlPjlNweDxkdHVWtUiry2i0ajUajqXE6a4ILwUfGJVStYspNtUn064UytE1E4dZQbpZMPI6kL5iQ+fs6YRD0XrulnWzFRrXrkUYMdb2C4LFZqb292CMIHlux2jVSX6hNio3OGrxepoRbA80ynaGuVxAcVuvGCrVrkgjzPuidNcZ6d2trfVuHV+2qpBNnjWYzNTQUF5sMRB4iHL+hNqkzVLQ0FJPJoHZ10kS4NdAsUbz29n4aZBEsSTyPns1cg2h302holmhoE1loFlloljlI1pex2VnZuy/vSdLGVZedlf3FF1+Iy/F/ISO+QPs+/zBJtVLdnJtl8rOPk1YplWVlZROR2Cyz+u4uOyvb7Rmbudz8NLeXirjiVy9XJqdS6ptzs8woKT163ikvOlTWNDQ0lJubS0RarZZm+sNkZ2Uzjviw0gdWiM0ST5sQ95QPy1q4XPw+M/5mYZzyIrMxj4hm2yyMU150z6uOWQVLnBIf9JmQ8qJDZU1Xr14VzzwrKCgg5T9JhqS8SMx6Ipox7jMk5UVZC5dLmyXG0ZsJKR9mNuaJzRL7CKLMSHnRPa864gyW+CX4y1gVUv7mH94u+9XHN1O6z7Dx8XG/3z86Onrr1i0iuvPlHXXqEW34t9YHdvxmWJ2di20yNDQkNkua8J14IWvh8qyFy7P2XFalAuFmCQQCSi+VFKf8zTfWmI15ZmOe2bjmNzdStttpxGb55JNPYjdLKlPee63vnlcd4r9HrwVStt+whAfLvD/rZsx9/f4N3/hfbhV6QLsv7ykvLyci8UTjtAq1T7t79M8t/qB7JPW77vv8w/Ly8vD51zGO3pQaPvu8Z+vkZx9Pfvaxx3jScuJTVWohnoIdO+tTbOPJMbdnzH3yWzf8qtUhDZtla1XlVy9XfvVy5UfLtCne9VcvVyY8WOZ70I8Nu75h3GO43zWk7mdd8ZUaCKjw5i9nxP3O4kcPPaJ/p0+dPJO4ffu2bLOkeNzG937Xt9eVicv6bW/0bnsoZbsWTX72cfjoJaLbt2+nuAJK2rfmmY155q1vqFuNdGuWkx1ij77vyN/UrEaigmWeXwLhyr+7+v+Dyv6DiOjKd9Z8X826jI6Oil+hqM/1tu1/XKQHLhIRuZ7ZW65aRcSXabo0S9oYHx/Pz88PBALpMId+48mxPY8R3XjNerKbHlutYk3EZlGxAlJbqypfW6R2JYgoFCx3vrxzN6+W+d2jH/7oP5Yd2rP78p7dh/7p2kdDM6+QGfocFze+/WHf5x/2vf1Eu+P3alcnLegfX/OJ7ayPiIh8J15Qa+gmLA0vKmDQY7ZUOhofH7/7DzrzOehv/uHK0Krvir347xuWvetV6avHNDP829f/+M/Pir348kc2vvW7PpUrlB4WP/vm+i7jwuVZC5cbPVtTP3STtoJDN48PPvLCYrXrkkZCQzeOey79We26JMB8Hrp58Ds/Oh6+UbTmcpGKdUkji59p7Qjf+N7ez7+nYl3Sin7bG5Pb1K5EmnnwhS73C2pXIv0YlpV+tUztSiTUfO7RAwBAHBD0AADMIegBAJhD0AMAMJfCoL/5h7fLmg6VdQ1HLMsY6iprOlTW1HUldLNJ6dRJacmItVJQMlFGflN1qI+I6PcHH1hR+sCKgy6lkr8/uPv3ROIVDlaUPrDC2qo093XWJft2ryh9YEXpAytKd8uekSmpW2ibyvW8S5e3L1yetXD5dhc59yyf6boFl7eLDw2ftSxcnrVwufypk65fZC1cnrXwBfvw9OVowe3EUTL+vSdGd5Mxz2zMa7pEdGlXrOsW3HjNGi4prvjT7pm3SUQ0/JvqXfKnaQW3ueY3N2bau3SPwbUUtpkYf37pVcc9rzpeuhG6qXiejLRkxFrJL/k3/6OvOu559ZPOiOWUSF3QD5+9/o+/3rP71/dfaRqSLkeXHGvro0N7dl9+ht74w9jNP7xd9ttrCtuUlhyWrpWSkgnjetv2P4iIPm19k97+sO/zg/TL38qkxfBvrQ/sbSci8QoHb3/Y9/mvVg3KzX2dU8nSQx/2ff5h28+/tbFS5kQdad1+c6xn1ZUP+z7/MElTsXwnTtKZjyc/O0K2s6amjyc/+9jzfy2zhua1Tq//WcvCna3iWu93ffvMx5OfvVPt+Z0vepuLn5/87OPJM8Y/Dk9bjuZ8rau69+PJM8Zdr12OXTL+vSfEzTea6eSY29NGx17r0+2Mdd0C/6Dh5JjbE5oJZaxuj2ObN4no0hH7/5Qv2Xfy/Kr3x9wnv2U/2X0z9t4lewyu9b7pdcV3mrvlvealqsqvXv4u/cHv/Zv/0Vf//WQcJTula6WkZOd/3Hrmx5Vf/fi/vnLpz9Llu33+8UnHoZv/7f+G8ftEVGQs+sv/fvA7P7r8jNKZTtKSHulaKSmZICO/cejqnyMiujm4+NFyIvreo0v9MldpW/xM6+cHNxIR0UPWY486VpQ+8ArteEbmhPA5lSQiot+fHXxeNr4ldev54I/0wT+vKE3aRdMGPcYny4mo7Mklw4NERJebPVuPy76pLH6297MjViIi0m9748nO5VkLf0ovPauPKqhf/BC5fpG1iZ4sn7YcraLpjbrFRETWdWWxS8a/94T41PetRx4jotWP/OMgLVpMl3aZt9Ijj8mUvDn8n+1bQz3uRS+1eto2ypSK3OanNPyb9011P5QvWfrzrh8sIiLa+PjqB2PuPfYeE847lvPkIiL6xpP3/7/ev9d99PJ3t8ZR8h3pWikpqa7UBf3iR7/h+mHTocbrEcuZzvW2v/KZb85ypb7dKz6q/LDv8330z4difyiOvySJ3Xa57ny0Vf/3h32fP+8/loppt74TJ0m2Oz+dc8/yd9Z9PPnZz6nuF07ZEuX/bbJ3caM40iJdlnF5e+djwbeWGUrGvfeEe+ywUk/5wRe63J4xt6fhxsnZ9KMvHbnx+EsxX4rdTe9X7nlshr1LlT7+LfvjeeaG87OoBlPrdDk/+ZXjng9uRSynRgp79N9fs/vynt0vfIN0edOWo/yD7s+eK0Q05Bm6/x9iblJa0hhzrWSUTIhPvcPtP1rxL29d/Jfdv3/QNPyRi4h+/9EfdQ/OsN63dMFpjMN/mqFbHX/JcLddhqRuK1ctnWE7d8lk9LzjIqLL71xfbJrq4M9o2dLgM/UMRj1T554X7MNEi7/57enLci5vX3jpyaYymrlkvHtPiIf0//m7S0TU/bv/ZfrTT8XeukH2qgV9P433msPSbdLwf7ZvzfvJr9/4iXx8dzcZHY/8fPXU9hX2Ps1jh92eMfeOb1HSrq9gyBt/5wYR/fmdv/zX2PuQlnwy5lrJKEmLvv3Vy5VffSeH8v7LtOWUSEnQX+nqukJjbb86VNZ0aDd9vzpPuhxdMq+6lHY3HSr7Lb3wHZn3AYWSi5XWSkbJhHAdOuiih6zH+j7/8F+fe+JfD33vIevz9KMVpQ/spZ9MH2ZxHYr42rN0x8oPvr+i9IEff/Dkvh8sTkxJopE/kdwbTLCeU3X7QXCbb+p2JHraresX212k37aVNi3PWriT6p/V06eDtNikUFKq4qU1bZblWQufbFv/87rFkSVDj55c+lKZdDl6m849O1vp36oWLs/aczl2ybj2nhCXdjVdogdfaKCteWZjNe146Qdbn/rg8TyzsXnR1tXRJUuVHo25zdIXutyesV/+8IVf/lxmm30/rW6nN35izDP/tFtx+5d2hb7UDQpe734rvZiM6yvc+OSlG2RYZqAOxz2v/jt9R6cY9FEl1ymtlbSSwWvcd9C+ZVrpcmKbREmCf2Eqc35eSnSorMnlCh7xOTk5RUVFeV+XeUfIqF+YIqLSB1bM2CwZ9fNSoqyFy+Nplsz5eSkiMhvzwm1CRDqdrqCgIPoyjZnz81Kie151xNMs8UvHL2MBACCBEPQAAMwh6AEAmJufQR+cWNv0dtsYXek6VNZ0qGmIiMbautT6lfA0EJ5eK1l2HQrPdP209ZBavxWuDskE12nTa8XJrnsuE5HvxC+Up7wyFpq2Kp3gKi7/tJuIbr6xS60fCldZcMKq49FrAbrxSfhi9N5rn6j7g4J3b14G/Zj7+v2H9uy+vO0f/UPDf6LyX+/5P8k7TEPD9N3lM52WyFZoeq10+VMv1V/58F/pd330ezf96AdJOPEhbUknuFZIptf6fHS49+MOuuSkyxfp+cSfIZPmJNNWpRNcbw5T3ftjvyRHH3X30s4fpMev6KWY98atb1VVfvXyY8+M/bnzb/TLH1deoP+nk/7soKKdf6925e7OvAz6vOofGz9qOlTmoGe/s/ib5Pph07+R4R/axvKqE38O5DwxNb1WuvyQgWzfX/Ev9MiDrZ9+01qoZgVTTjrBlYjC02v1etplWV5Fj5lO/MmUwt+Zkp5yoybJtFXpBNcHF5P98byfUOVDb3i/mak/NWVYVvqk33HPq9fon3Tr/p5+8ivHevo/DNcCplSdBJk88zLoh5uaPI/u2X25khq7hsW5V3tomIqoKQUXIEtL0um10uXy3X2ff9h3iNxUSruTehmyWZuYnMhauDzJO5ma4Do1vbb8v01+9vFkE12kR2hP8NJpmSs8wVWc2fRz6qV19FPpZc4ySOclxzu6yq9eXkYffNIpzml6jBz0DboU46Jm80OCg35icuJQWVNitymnMD84RPPnsZtERGNtY3nVYx56ZvevV9GfUnQasvQkenVJp9dKl4OPtn76TevNj+hg35V/Jq/SNSwTRnoSvaqmJrhS1PRa34k/mbbdeIeOTPbuJp/KPxQuNTE5YTam6INp9ATXm294v/mC93fU5n7/FRpOo68vJiYn7nnVkfz95C0NzoAfH/wbEZH3WsC07P97h7771Y+L6W+B5FeAKOok+oRI/G/GfvHFF/fdd19Sp00tfnbJlR82uYgKd2770YNEN//w71S0hvKImg79kJYd+k7ydh02q5SfmJxI6pyph6zH+qzUt/sQHfreQ/S98DIR0fBvz1LpXiokWlH6fdr49jNJqoNoVik/MTmRlbRpU849O1uJWhf+G206Mtm0aJAWPxF+bPhsMz1ynB4iWp5lIeuZZ5NRAalZjduIr5YUTJsq3frU64/n2em7de93ERHdeO0srdtDi4nyzI/TxpMvJXXv4vvZbJslqdOm1v1TwSu/cvyEqLTssY/+nuhv/l/SN14jLZHjnl/R1qpUzNhKRspTwmfGEtGdL+/cunWrqKiI8RRZ2ZSPMTOWiO58eee+++4jIsZTZGVTPnazjP11LD8/n/EUWXF4am7NwniKbMSE2LDYU0DFZmE8RVY25XNycvLz8+9yZmzie/RElJube/Xq1YcffjgZG08Hc3vLHRoaGh0dffgBNMsUrVY7NDSUtbAoGfVJB0ptkp+fH3vFq1evPpyqMZzUm3On9erVq/dkXrDk5ube5ZYTH/QL7l0QCATy8/PTY6A2dWY8dHNzc0dHRzOqWcTOSOwyYrdgfHw8NVVKBzk5OUSk1cY6l6OoqCgzmyW2jA2Wu+nOU5LOuhFfwTqdLhkbT0/ik41x6Ip/p/z8/HhezWzk5+fn5uYqDVBQRjaL+OaXm5sb49AVW2zG90hO4mkWBMucJX6MXiSO1BPR6OgoEXHtmIjxJB6QBQUFNNMb79hfx27fvk1Eo6OjXNuEopplxs6I2Cy8XyokaZbc3FytVhu7WTLkCCLJxz40S9hsg2VGSQx6IgoEUnRCkurEt9wZ/xhoFll3vryTOW1CRDPGGeGlogDNMjfJCnoAAEgT83JmLAAAxA9BDwDAHIIeAIA5BD0AAHMIegAA5hD0AADMIegBAJhD0AMAMIegBwBgDkEPAMAcgh4AgDkEPQAAcwh6AADmEPQAAMwh6AEAmEPQAwAwh6AHAGAOQQ8AwByCHgCAOQQ9AABzCHoAAOYQ9AAAzCHoAQCYQ9ADADCHoAcAYA5BDwDAHIIeAIA5BD0AAHMIegAA5hD0AADMIegBAJhD0AMAMIegBwBgDkEPAMAcgh4AgDkEPQAAcwh6AADmEPQAAMwh6AEAmEPQAwAwh6AHAGAOQQ8AwByCHgCAOQQ9AABzCHoAAOYQ9AAAzCHoAQCYQ9Bz5ztSlpWdPe3f9s4Zym/vlF2Yzb62O8P3dm4X77Qc8SntK+Jei3T15JhtVRVXCT8k00Q+e1lEs0+/R25T4S1KG2Fq17LNVTa9utH3QKZD0GeCbR2TExOhf4OH+6tkg+xudW43tlV7JiYmJyY8h/urxKzxHbFUUcfExOTEYHWbSRpTzu3Zxl19UVvx2TfL3KtuVRVXifVEiMjzx75tHeGWP76OSF93OfyHmOjYRqWHGypkVpzeCFO7lvvb6Xf2Xt6pn3tbQCZA0Gcc/RPVpX0DHvFGZC+1c7txVx+dqMrKzg4uRAReqM8b3bV0tp+w7g8mjn7nfmvfwCAReQb6tm2sCO23tb0zuJXs7Kr+wx2HSyM24juyua1kW+S9U49G9qmlXelp3epw33z79uju7WyqGnMVuScyVQ3f4CelxSaF50Kd26v6D7+5Ux9Z86hG8A32l1ZX6YmI9HX7t4X/duHSiv133xFLdrbliM93pMyyfbsl/FeL/iP6jljKjti3i21bZveRU7IcVwHZzUK6QNBnHN/Ftr7SYiNRVC91eyetO+45XCp+AgguHF8nWbdze1X/4cFg1zLicK44PjFVtrO9tbTYJIaUuC8ivamE+gd9RETrjk9MTF7eGRmCviPPt1W/2VAsX/Ho2ioK13NiP52I7mzPpqqxVpF9Ivqdl4ON5hno69tllB+i8dkbpe8cl6faOaoR9KaSvrYOX2itcCVn0rnd1FY9ONG7U09EfSdof/BTxVTjdJDk80Hfrj9uFNuWdpmy3wkvN3fGVyDWawPUhqDPBCeqJIPCprbqQfHgp3XHJ0Of+vWmkpm309neWlr9hJ7ErmVEn3eK74ilqv/w6Z16osGB+IdhfPbNbdWnlUch4q9tZ3vrtv11eiKiioaoTw13WVXJKjMUHOyn0sPiO9PkYHGjtN/d2byLDjesk1lJphHWHZ/cP2CM+NvNoO357Malg5frwmWDH1amN87GbaG3EKLSYH30VdWl4WXpG17sAnG+NkAdCPpMEBqj79hGVBocLgjp3C6+AVSdiGtT4S5q1YmIPm94e1mmtupQxJiKY8WslO/I5rbq03XTQixUt+zsUA8xrtpK++bKm5pTVaevEpt+5+XwOxPpTd8OjvYQETnbT4RGY6bXXKYRyHekLKuxWHzD2D9gimtgpI+qD5eEM3za1gb7p24Y4/7zxGPG1waoBkGfSSqODx6mXcZpA9ntTwYHQ+I75KXf60Z9B+g7UpZVRR0TUzmoN5VMfR8w2E8lJoWE9F1s6+vbZcrKzs4y7eqjE1XZZXbfuuOhfYlDDnHWVrrTkOmbmlNVo1eZq853FHJerhFocKAvXLpi47a4MrS0+omdDdVtm+1RRad9GPLM4gPXzGK+NkBVCPrMoq87fbj0RFXoy8L+qU/0RDMnyLqN1hONYnY4t0eeg+g7UmbcVdIxcXzaaSTG4tLgKr6LbX3WjTKjFcGKhU9HGTxcStui81S2tpKxBd/FtlBqSevZLHdmz+yrKr9KTNOayDf4SbjyvsFPgqMccTWCqbg0PMDibD+h/GYZtbXT1W2bo76nlTaOwgeLuYj52gC1IegzjX7nm4dLW6vK7D7S7zx9uD84fP/8QElp38CgOAJ7oipre2d4QbLyuuMdJbtM2VnZ2eEzRkLEnD1RFXGGuH5nb3AVU1v14HGlnI+r4jK1pXUNh0kcMdhM1dui6/lOcXTnfw5VVVhFTvgUmorjg9VtpmD5zfRmeItR/ejYMxX0Oy93lARHRar6D3sUGlFmI/qdb1a3GSO3LPkjUkd8I/7xiPHaANVpJiYn1K4DQNL4jpQZB/ZP3s07TJrr3J7VWOzBUAnEgh498OM7Ygl1vY1t1Upd4PnPZy/LzqpK3PALsIUePQAAc+jRAwAw9/8D9gpxT2sI0M8AAAAASUVORK5CYII=" alt="plot of chunk unnamed-chunk-4"/> </p>

<pre><code class="r">confusionMatrix(trainingset$classe, predict(modelFitTree, newdata = trainingset))
</code></pre>

<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 3556   54  274    0   11
##          B 1098  919  661    0    0
##          C 1095   74 1220    0    0
##          D 1005  405  844    0    0
##          E  387  335  670    0 1130
## 
## Overall Statistics
##                                         
##                Accuracy : 0.497         
##                  95% CI : (0.488, 0.505)
##     No Information Rate : 0.52          
##     P-Value [Acc &gt; NIR] : 1             
##                                         
##                   Kappa : 0.343         
##  Mcnemar&#39;s Test P-Value : NA            
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity             0.498   0.5143   0.3325       NA   0.9904
## Specificity             0.949   0.8528   0.8839    0.836   0.8895
## Pos Pred Value          0.913   0.3432   0.5107       NA   0.4481
## Neg Pred Value          0.636   0.9215   0.7842       NA   0.9990
## Prevalence              0.520   0.1301   0.2671    0.000   0.0831
## Detection Rate          0.259   0.0669   0.0888    0.000   0.0823
## Detection Prevalence    0.284   0.1949   0.1739    0.164   0.1836
## Balanced Accuracy       0.723   0.6835   0.6082       NA   0.9399
</code></pre>

<pre><code class="r">confusionMatrix(validationset$classe, predict(modelFitTree, newdata = validationset))
</code></pre>

<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 1044   17   99    0    3
##          B  330  292  194    0    0
##          C  304   28  362    0    0
##          D  311  139  241    0    0
##          E  123  109  193    0  328
## 
## Overall Statistics
##                                         
##                Accuracy : 0.492         
##                  95% CI : (0.477, 0.507)
##     No Information Rate : 0.513         
##     P-Value [Acc &gt; NIR] : 0.996         
##                                         
##                   Kappa : 0.338         
##  Mcnemar&#39;s Test P-Value : NA            
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity             0.494   0.4991   0.3324       NA   0.9909
## Specificity             0.941   0.8516   0.8904    0.832   0.8877
## Pos Pred Value          0.898   0.3578   0.5216       NA   0.4356
## Neg Pred Value          0.638   0.9112   0.7876       NA   0.9991
## Prevalence              0.513   0.1421   0.2645    0.000   0.0804
## Detection Rate          0.254   0.0709   0.0879    0.000   0.0797
## Detection Prevalence    0.282   0.1982   0.1686    0.168   0.1829
## Balanced Accuracy       0.717   0.6754   0.6114       NA   0.9393
</code></pre>

<pre><code class="r"># -- random forest - use randomForest package itself which includes combine function for doParallel
cl &lt;- makePSOCKcluster(6)
registerDoParallel(cl)
modelFitRF &lt;- foreach(ntree=rep(50, 6), .combine=randomForest::combine, .packages=&#39;randomForest&#39;) %dopar% {
 randomForest(trainingset[,-53], trainingset$classe, ntree=ntree)

}
stopCluster(cl)

confusionMatrix(trainingset$classe, predict(modelFitRF, newdata = trainingset))
</code></pre>

<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 3895    0    0    0    0
##          B    0 2678    0    0    0
##          C    0    0 2389    0    0
##          D    0    0    0 2254    0
##          E    0    0    0    0 2522
## 
## Overall Statistics
##                                 
##                Accuracy : 1     
##                  95% CI : (1, 1)
##     No Information Rate : 0.284 
##     P-Value [Acc &gt; NIR] : &lt;2e-16
##                                 
##                   Kappa : 1     
##  Mcnemar&#39;s Test P-Value : NA    
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity             1.000    1.000    1.000    1.000    1.000
## Specificity             1.000    1.000    1.000    1.000    1.000
## Pos Pred Value          1.000    1.000    1.000    1.000    1.000
## Neg Pred Value          1.000    1.000    1.000    1.000    1.000
## Prevalence              0.284    0.195    0.174    0.164    0.184
## Detection Rate          0.284    0.195    0.174    0.164    0.184
## Detection Prevalence    0.284    0.195    0.174    0.164    0.184
## Balanced Accuracy       1.000    1.000    1.000    1.000    1.000
</code></pre>

<pre><code class="r">confusionMatrix(validationset$classe, predict(modelFitRF, newdata = validationset))
</code></pre>

<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 1163    0    0    0    0
##          B    0  816    0    0    0
##          C    0    0  694    0    0
##          D    0    0    0  691    0
##          E    0    0    0    0  753
## 
## Overall Statistics
##                                     
##                Accuracy : 1         
##                  95% CI : (0.999, 1)
##     No Information Rate : 0.282     
##     P-Value [Acc &gt; NIR] : &lt;2e-16    
##                                     
##                   Kappa : 1         
##  Mcnemar&#39;s Test P-Value : NA        
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity             1.000    1.000    1.000    1.000    1.000
## Specificity             1.000    1.000    1.000    1.000    1.000
## Pos Pred Value          1.000    1.000    1.000    1.000    1.000
## Neg Pred Value          1.000    1.000    1.000    1.000    1.000
## Prevalence              0.282    0.198    0.169    0.168    0.183
## Detection Rate          0.282    0.198    0.169    0.168    0.183
## Detection Prevalence    0.282    0.198    0.169    0.168    0.183
## Balanced Accuracy       1.000    1.000    1.000    1.000    1.000
</code></pre>

<pre><code class="r">varImpPlot(modelFitRF, n = 10)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAtFBMVEX9/v0AAAAAADkAAGUAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85Zo85ZrU5j485j9plAABlADllAGVlOQBlOTllOY9lZgBlZjllZmVlZrVlj49ltbVltf2POQCPOTmPOWWPZgCPZo+PjzmPj2WPtY+P27WP29qP2/21ZgC1Zjm1tWW124+1/rW1/tq1/v2+vr7ajznaj2Xa24/a/rXa/tra/v39tWX924/9/rX9/tr9/v0pPVFlAAAAPHRSTlP//////////////////////////////////////////////////////////////////////////////wC7iOunAAAACXBIWXMAAAsSAAALEgHS3X78AAASK0lEQVR4nO2dDXvaOBaFx0lTCM22pKSZZnch7U53FrJNU3ZmwNj//3+triTbsvmOZBCc8z6lJLalOHkj2fDkHv2SE0h+OfYJkONA8aBQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aBQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8buxuL2aOZ9cvmSjRDOUT/J8MlRb9Qb1WbnviCe8DYrfjfXi9ZZJUopPrmYUf2rMk7cjNWSnxpl6SvrqWTz+U4ufGptGvAz0XH/yQ0R3zNCv7YsYineZJwXK3ER/0CkmbiXebOlT/NkxV8LTrly3L8Zp92Kcmw+UxqkSn3aVfJHqTPUdbbo21Ze/Kp1jfzuboHiXuRWZjS7Gcy1umgz1B3KNt/PBxXij+GFO8SeHES93ZzuIr6b6QrzMBXJXwKn+1HDFr5nqhfXic7lQUPzJ4Ypfe3N3NVslvri5mya8uTs9auJrL+c+6JdzE/MLsCxeDfSrP7V4dXCH4km0UDwoFA8KxYNC8aBQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aBQPCgUDwrFg0LxoFA8KBQPSnziExKGzT/mCMUf+wTOBIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB6UYOLT3ov6V3w2Ga7d5QnFh4HicajVRvuJT9/d6XUzZWm1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" alt="plot of chunk unnamed-chunk-4"/> </p>

<p>The random forest model performs far better than the tree, therefore this model is used to predict the values in the testset. The values are already submitted and it scored a 20 out of 20 correct. roll_belt is by far the best predictor, followed by yaw_belt, pitch_forearm and magnet_dumbbell_z.</p>

<pre><code class="r">predict(modelFitRF, newdata = testset)
</code></pre>

<pre><code>##  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 
##  B  A  B  A  A  E  D  B  A  A  B  C  B  A  E  E  A  B  B  B 
## Levels: A B C D E
</code></pre>

<pre><code class="r">pml_write_files = function(x){
  n = length(x)
  for(i in 1:n){
    filename = paste0(&quot;problem_id_&quot;,i,&quot;.txt&quot;)
    write.table(x[i],file=filename,quote=FALSE,row.names=FALSE,col.names=FALSE)
  }
}

pml_write_files(predict(modelFitRF, newdata = testset))
</code></pre>

</body>

</html>

